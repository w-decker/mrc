devtools::document()
devtools::document()
devtools::install_github("w-decker/mrc")
?deltaR2
help(package="mrc")
d <- simdat(n=100, r=0.4)
View(d)
s <- spr(y ~ x1 + x2, vint= x1, data=d)
deltaR2(y ~ x1 + x2, restrim = y ~ x1, data=d)
deltaR2(y ~ x1 + x2, restrim = y ~ x1, data = d)
str(d)
View(d)
?deltaR2
deltaR2(fullm = y ~ x1 + x2, restrim = y ~ x1, data = d)
d <- simdat(n=100, r=0.4)
deltaR2(fullm = y ~ x1 + x2, restrim = y ~ x1, data = d)
source("/Users/lendlab/Desktop/dr2.R")
d <- simdat(n=100, r=0.4)
library(mrc)
d <- simdat(n=100, r=0.4)
View(d)
("/Users/lendlab/Desktop/dr2.R")
source("/Users/lendlab/Desktop/dr2.R")
dr2()
source("/Users/lendlab/Desktop/dr2.R")
dr2()
dr2(fullm = y~x1 + x2, restrim = y~ x2, data = d)
source("/Users/lendlab/Desktop/dr2.R")
source("/Users/lendlab/Desktop/dr2.R")
simdat2(n=100, r=0.4)
d <- simdat2(n=100, r=0.4)
dr2(fullm = y~x1 + x2, restrim = y~ x2, data = d)
dr2(fullm = y~x1 + x2, restrim = y~ x2, data = data)
data <- simdat2(n=100, r=0.4)
dr2(fullm = y~x1 + x2, restrim = y~ x2, data = data)
?scale
cc <- scale(data)
cc <- scale(data, center = TRUE)
cc <- data.frame(scale(data, center = TRUE))
View(cc)
View(d)
View(data)
View(cc)
c <- simdat(n=100, r=0.4)
cc <- data.frame(scale(c, center = TRUE))
View(c)
View(cc)
View(c)
View(cc)
mean(c$y)
mean(cc$y)
sd(cc$y)
sd(c$y)
?devtools::document()
devtools::document()
rm(list = c("deltaR2"))
devtools::document()
devtools::document()
library(mrc)
d <- simdat(n=100, r=0.4)
d <- simdat(n=100, r=0.4)
deltaR2(fullm = y ~ x1 + x2, restrim = y ~ x2, data=d)
spr(y ~ x1 + x2, vint=x2, data=d)
spr <- function(f, vint, data ){
x <- cor(f[[2]],
resid(lm(labels(terms(f))[1] ~ labels(terms(f))[1]),
data = data))
return(x)
}
d <- simdat(n=100, r=0.001)
spr(y ~ x1 + x2, vint = x1, data = d)
cor(y, resid(lm(x1 ~x2)))
cor(y, resid(lm(x1 ~x2, data = d)), data = d)
cor(d$y, resid(lm(x1 ~x2, data = d)))
spr <- function(f, vint, data ){
x <- cor(d$f[[2]],
resid(lm(labels(terms(f))[1] ~ labels(terms(f))[1]),
data = data))
return(x)
}
spr(y ~ x1 + x2, vint = x1, data = d)
x <- y ~ x1 + x2
terms(x)
terms(variables(x))
variables(x)
attr(x, "variables")
terms(x)
attr(, "variables")
attr(x,  "variables")
attr(x,  "term.lables")
attr(x,  "factors")
lhs(x)
help(package="formula.parts")
help(package="Formula")
help(package="formula.tools")
install.packages("formula.tools")
lhs(x)
formula.tools::lhs(x)
str(formula.tools::lhs(x))
d$formula.tools::lhs(x)
d[formula.tools::lhs(x)]
d[as.character(formula.tools::lhs(x))]
spr <- function(f, vint, data ){
x <- cor(d[as.character(formula.tools::lhs(f))],
resid(lm(labels(terms(f))[1] ~ labels(terms(f))[1]),
data = data))
return(x)
}
d <- simdat(n=100, r=0.001)
spr(y ~ x1 + x2, vint = x1, data = d)
library(formula.tools)
cor(d[as.character(lhs(x))], resid(lm(x1 ~ x2, data = d)))
lhs(x)
x1
spr <- function(f, vint, data ){
x <- cor(data[as.character(formula.tools::lhs(f))],
resid(lm(labels(terms(f))[1] ~ labels(terms(f))[1]),
data = data))
return(x)
}
spr(y ~ x1 + x2, vint = x1, data = d)
spr333 <- function(f, vint, data ){
x <- cor(data[as.character(formula.tools::lhs(f))],
resid(lm(labels(terms(f))[1] ~ labels(terms(f))[1]),
data = data))
return(x)
}
spr333(y ~ x1 + x2, vint = x1, data = d)
rhs(x)
spr333 <- function(f, vint, data ){
x <- cor(data[as.character(formula.tools::lhs(f))],
resid(lm(formula.tools::rhs(f), data = data)))
return(x)
}
spr333(y ~ x1 + x2, vint = x1, data = d)
spr333 <- function(f, vint, data ){
x <- cor(data[as.character(formula.tools::lhs(f))],
resid(lm(as.character(formula.tools::rhs(f)), data = data)))
return(x)
}
spr333(y ~ x1 + x2, vint = x1, data = d)
spr333 <- function(f, vint, data ){
x <- cor(data[as.character(formula.tools::lhs(f))],
resid(lm(formula.tools::rhs(f)), data = data))
return(x)
}
spr333(y ~ x1 + x2, vint = x1, data = d)
spr333 <- function(f, vint, data ){
x <- cor(data[as.character(formula.tools::lhs(f))],
resid(lm(formula.tools::rhs(f), data = data)))
return(x)
}
spr333(y ~ x1 + x2, vint = x1, data = d)
str(x2)
str(formula.tools::rhs(f))
formula.tools::rhs(x)
t <- formula.tools::rhs(x)
str(t)
t <- as.symbol(formula.tools::rhs(x))
terms(labels(x))
labels(terms(x))
labels(terms(x))
t < x1
t <- x1
p <- c(1, 2, 3, 4, 5)
xxx <- p ! in ttt
xxx <- p in !ttt
spr333 <- function(f, vint, data ){
x <- cor(data[as.character(formula.tools::lhs(f))],
resid(lm(vint ~ labels(terms(f[!= vint]))), data = data))
spr333 <- function(f, vint, data ){
x <- cor(data[as.character(formula.tools::lhs(f))],
resid(lm(vint ~ labels(terms(f)))[labels(terms(f))!= vint], data = data))
return(x)
}
spr333(y ~ x1 + x2, vint = x1, data = d)
op(x)
?rhs
rhs(x)
as.list(rhs(x))
spr333(y ~ x1 + x2, vint = x1, data= d)
as.list(rhs(x))
?mapply
?setdiff
ind <- as.list(formula.tools::rhs(x)
ind <- as.list(formula.tools::rhs(x))
ind <- as.list(formula.tools::rhs(x))
View(ind)
vnt <- mapply(setdiff, ind, as.list(vint))
x1 <- c(1, 2, 3)
vint <- x1
ind <- as.list(formula.tools::rhs(x))
vnt <- mapply(setdiff, ind, as.list(vint))
?type.convert()
ind <- as.list(deparse(formula.tools::rhs(x)))
ind
str(ind)
ind[1]
ind[[1]]
ind[[[1]]
ind[[[1]]]
split(ind, "+")
cv <- split(ind, "+")
cv
cv <- split(x, sep = "+")
cv <- split(x, f = "+", sep = "+")
cv
cv <- split(x, f = x, sep = "+")
cv <- strplit(ind, split = "+")
cv <- strsplit(ind, split = "+")
spr333 <- function(f, voi, vni, data){
x <- cor(data[as.character(formula.tools::lhs(f))],
resid(lm(vint ~ vni , data = data)))
return(x)
}
spr333(y ~ x1 + x2, voi = x1, vni = x2, data = d)
spr333 <- function(f, voi, vni, data){
x <- cor(data[as.character(formula.tools::lhs(f))],
resid(lm(voi ~ vni, data = data)))
return(x)
}
spr333(y ~ x1 + x2, voi = x1, vni = x2, data = d)
View(d)
spr333 <- function(f, voi, vni, data){
x <- cor(data[as.character(formula.tools::lhs(f))],
resid(lm(data[as.character(voi)] ~ data[as.character(vni)], data = data)))
return(x)
}
spr333(y ~ x1 + x2, voi = x1, vni = x2, data = d)
spr333 <- function(dep, ivi, ivn){
x <- cor(dep, resid(lm(ivi ~ ivn)))
return(x)
}
spr333(dep = d$y, ivi = d$x1, ivn = d$x2)
x <- y~ x1 + x2
labels(terms(x))
as.vector(labels(terms(x)))
int <- x1
int <- as.vector(x1)
int
v <- as.character(labels(terms(x)))
v
ivi <- v[1]
ivi
ivn <- mapply(setdiff, indep, ivi)
ivn <- mapply(setdiff, v, ivi)
ivn
ivi
str(ivn)
?mapply
ivn
ivn[1]
ivn[2]
ivn <- mapply(setdiff, v, ivi)[2]
ivn
sprf <- function(f, ivi, data){
dep <- formula.tools::lhs(f)
indep <- labels(terms(f))
ivi <- indep[ivi]
ivn <- mapply(setdiff, indep, ivi)
cor(dep, resid(lm(data[ivi] ~ data[ivn])))
}
sprf(y~x1 + x2, ivi = 1, data = d)
ivn
sprf <- function(f, ivi, data){
dep <- formula.tools::lhs(f)
indep <- labels(terms(f))
ivi <- indep[ivi]
ivn <- mapply(setdiff, indep, ivi)
cor(dep, resid(lm(data[ivi] ~ data[as.character(ivn)])))
}
sprf(y~x1 + x2, ivi = 1, data = d)
sprf <- function(f, ivi, data){
dep <- formula.tools::lhs(f)
indep <- labels(terms(f))
ivi <- indep[ivi]
ivn <- mapply(setdiff, indep, ivi)
cor(dep, resid(lm(data[ivi] ~ data[ivn[1]])))
}
sprf(y~x1 + x2, ivi = 1, data = d)
sprf <- function(f, ivi, data){
dep <- formula.tools::lhs(f)
indep <- labels(terms(f))
ivi <- indep[ivi]
ivn <- mapply(setdiff, indep, ivi)
cor(dep, resid(lm(data[ivi] ~ data[ivn])))
}
sprf(y~x1 + x2, ivi = 1, data = d)
sprf <- function(f, ivi, data){
dep <- formula.tools::lhs(f)
indep <- labels(terms(f))
ivi <- indep[ivi]
ivn <- mapply(setdiff, indep, ivi)
cor(dep, resid(lm(data[ivi] ~ data[ivn[2]])))
}
sprf(y~x1 + x2, ivi = 1, data = d)
sprf <- function(f, ivi, data){
dep <- formula.tools::lhs(f)
indep <- labels(terms(f))
ivi <- indep[ivi]
ivn <- mapply(setdiff, indep, ivi)
cor(dep, resid(lm(data[ivi] ~ data[as.character(ivn[2]])))
sprf <- function(f, ivi, data){
dep <- formula.tools::lhs(f)
indep <- labels(terms(f))
ivi <- indep[ivi]
ivn <- mapply(setdiff, indep, ivi)
cor(dep, resid(lm(data[ivi] ~ data[as.character(ivn[2])]))
}
sprf <- function(f, ivi, data){
dep <- formula.tools::lhs(f)
indep <- labels(terms(f))
ivi <- indep[ivi]
ivn <- mapply(setdiff, indep, ivi)
cor(dep, resid(lm(data[ivi] ~ data[as.character(ivn[2])])))
}
sprf(y~x1 + x2, ivi = 1, data = d)
f <- y ~ x1 + x2
dep <- formula.tools::lhs(f)
dep
indep <- labels(terms(f))
indep
str(indep)
ivi <- indep[ivi]
str(ivi)
ivi <- indep[ivi]
str(ivi)
ivi <- 1
ivi <- indep[ivi]
str(ivi)
ivn <- mapply(setdiff, indep, ivi)
str(ivn)
ivn <- setdiff(ivi, indep)
ivn
ivii <- 1
dep <- formula.tools::lhs(f)
indep <- labels(terms(f))
ivi <- indep[ivii]
ivn <- setdiff(indep, indep)
ivn
?setdiff
indep <- as.list(labels(terms(f)))
ivn <- setdiff(indep, indep)
ivn
ivn <- setdiff(indep, indep)
ivn <- setdiff(ivi, indep)
ivn
ivi <- indep[ivii]
ivi
indep
indep <- labels(terms(f))
indep
indep <- as.list(labels(terms(f)))
ivi <- indep[ivii]
ivn <- setdiff(as.list(ivi), indep)
ivn
as.list(ivi)
ivn <- setdiff(indep, as.list(ivi))
ivn
sprf <- function(f, ivii, data){
dep <- formula.tools::lhs(f)
indep <- as.list(labels(terms(f)))
ivi <- indep[ivii]
ivn <- setdiff(indep, as.list(ivi))
cor(dep, resid(lm(data[ivi] ~ data[ivn])))
}
sprf(y~x1 + x2, ivi = 1, data = d)
str(ivn)
str(ivn[1])
str(as.character(ivn[1]))
str(as.character(ivn))
sprf <- function(f, ivii, data){
dep <- formula.tools::lhs(f)
indep <- labels(terms(f))
ivi <- indep[ivii]
ivn <- setdiff(as.list(indep), as.list(ivi))
cor(dep, resid(lm(data[ivi] ~ data[as.character(ivn)])))
}
sprf(y~x1 + x2, ivi = 1, data = d)
sprf <- function(f, ivii, data){
dep <- formula.tools::lhs(f)
indep <- labels(terms(f))
ivi <- indep[ivii]
ivn <- setdiff(as.list(indep), as.list(ivi))
cor(dep, resid(lm(data[as.character(ivi)] ~ data[as.character(ivn)])))
}
sprf(y~x1 + x2, ivi = 1, data = d)
f <- y ~ x1 + x2
ivii <- 1
dep <- formula.tools::lhs(f)
indep <- as.list(labels(terms(f)))
ivi <- indep[ivii]
ivn <- setdiff(indep, as.list(ivi))
str(as.character(ivn))
d[ivn]
d[as.character(ivn)]
d[ivi]
d[as.character(ivi)]
sprf <- function(f, ivii, data){
dep <- formula.tools::lhs(f)
indep <- as.list(labels(terms(f)))
ivi <- indep[ivii]
ivn <- setdiff(indep, as.list(ivi))
cor(dep, resid(lm(data[as.character(ivi)] ~ data[as.character(ivn)])))
}
sprf(y~x1 + x2, ivi = 1, data = d)
d <- mrc::simdat(n=100, r=0.2)
sprf(y~x1 + x2, ivi = 1, data = d)
f <- y ~ x1 + x2
ivii <- 1
dep <- formula.tools::lhs(f)
indep <- as.list(labels(terms(f)))
ivi <- indep[ivii]
ivn <- setdiff(indep, as.list(ivi))
str(as.character(ivn))
d[as.character(ivn)]
d[as.character(ivi)]
cor(dep, resid(lm(x1 ~ x2)))
x1 <- d[as.character(ivn)]
x2 <- d[as.character(ivi)]
cor(dep, resid(lm(x1 ~ x2)))
str(x1)
sprf <- function(f, ivii, data){
dep <- formula.tools::lhs(f)
indep <- as.list(labels(terms(f)))
ivi <- indep[ivii]
ivn <- setdiff(indep, as.list(ivi))
cor(dep, resid(lm(data[as.character(ivi)] ~ data[as.character(ivn)])))
}
sprf(y~x1 + x2, ivi = 1, data = d)
sprf3 <- function(f, ivii, data){
dep <- formula.tools::lhs(f)
indep <- as.list(labels(terms(f)))
ivi <- indep[ivii]
ivn <- setdiff(indep, as.list(ivi))
formula_string <- paste(names(dep), "~", paste(names(ivi), paste(names(ivn), collapse = " + "), sep = " + "))
formula_lm <- as.formula(formula_string)
cor(dep, resid(lm(formula_lm, data = data)))
}
sprf3(y ~ x1 + x2, ivii = 1, data = d)
sprf4 <- function(f, ivii, data){
dep <- formula.tools::lhs(f)
indep <- as.list(labels(terms(f)))
ivi <- indep[ivii]
ivn <- setdiff(indep, as.list(ivi))
if (length(dep) == 0 || length(ivi) == 0 || length(ivn) == 0) {
stop("Invalid formula or independent variable index")
}
formula_string <- paste(names(dep), "~", paste(names(ivi), paste(names(ivn), collapse = " + "), sep = " + "))
formula_lm <- as.formula(formula_string)
cor(dep, resid(lm(formula_lm, data = data)))
}
sprf4(y ~ x1 + x2, ivii = 1, data = d)
sprf5 <- function(f, ivii, data) {
dep <- formula.tools::lhs(f)
indep <- as.list(labels(terms(f)))
ivi <- indep[ivii]
ivn <- setdiff(indep, as.list(ivi))
formula_string <- paste(deparse(dep), "~", paste(deparse(ivi), paste(deparse(ivn), collapse = " + "), sep = " + "))
formula_lm <- as.formula(formula_string)
cor(dep, resid(lm(formula_lm, data = data)))
}
# Example usage
sprf5(y ~ x1 + x2, ivii = 1, data = your_data_frame)
# Example usage
sprf5(y ~ x1 + x2, ivii = 1, data = d)
sprf6 <- function(f, ivii, data) {
dep <- formula.tools::lhs(f)
indep <- as.list(labels(terms(f)))
ivi <- indep[ivii]
ivn <- setdiff(indep, ivi)
formula_lm <- as.formula(paste(dep, "~", paste(ivi, paste(ivn, collapse = " + "), sep = " + ")))
cor(dep, resid(lm(formula_lm, data = data)))
}
# Example usage
sprf6(y ~ x1 + x2, ivii = 1, data = d)
f <- y ~ x1 + x2
ivii <- 2
dep <- formula.tools::lhs(f)
indep <- as.list(labels(terms(f)))
ivi <- indep[ivii]
ivn <- setdiff(indep, as.list(ivi))
cor(dep, resid(lm(data[as.character(ivi)] ~ data[as.character(ivn)])))
ivi
str(ivi)
deparse(ivi)
unlist(ivi)
str(unlist(ivi))
cor(dep, resid(lm(data[as.character(unlist(ivi))] ~ data[as.character(ivn)])))
cor(dep, resid(lm(data[unlist(ivi)] ~ data[as.character(ivn)])))
?data
cor(dep, resid(lm(d[unlist(ivi)] ~ d[as.character(ivn)])))
ivn <- unlist(ivn)
ivn
ivn <- unlist(ivn)
ivn
ivi
ivi <- unlist(ivi)
ivi
cor(dep, resid(lm(d[unlist(ivi)] ~ d[ivn])))
cor(dep, resid(lm(d[ivi] ~ d[ivn])))
ivi
ivn
str(ivn)
str(ivi)
d[ivi]
mean(d[ivi])
mean(d$ivi)
mean(d[as.character(ivi)])
d[ivi]
cor(dep, resid(lm(as.data.frame(d[ivi]) ~ as.data.frame(d[ivn]))))
cor(dep, resid(lm(data.frame(d[ivi]) ~ data.frame(d[ivn]))))
